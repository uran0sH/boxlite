# BoxLite C Examples

This directory contains examples demonstrating how to use the BoxLite C API.

## Prerequisites

1. Build the BoxLite C SDK:
   ```bash
   cd ../../sdks/c
   cargo build --release
   ```

   This will create:
   - `libboxlite.{dylib,so}` in `../../target/release/`
   - `boxlite.h` in `../../sdks/c/include/`

## Building Examples

```bash
# From this directory (examples/c/)
mkdir -p build
cd build
cmake ..
make
```

## Running Examples

### execute.c - Basic Command Execution

Demonstrates creating a container and executing multiple commands with streaming output.

```bash
./execute
```

Expected output:
```
ðŸš€ BoxLite C API Example
Version: 0.1.0

ðŸ“¦ Created container, executing commands...

Command 1: ls -alrt /
---
[directory listing output...]

Command 2: ip addr
---
[network interface output...]

Command 3: env
---
[environment variables...]

âœ… Execution completed!
```

## API Overview

The C API uses JSON for complex types to avoid ABI compatibility issues:

```c
// Create runtime
char* error = NULL;
BoxliteRuntime* runtime = boxlite_runtime_new(NULL, &error);

// Create box (JSON options)
const char* opts = "{\"image\":{\"Reference\":\"alpine:3.19\"}}";
BoxHandle* box = boxlite_create_box(runtime, opts, &error);

// Execute command (JSON args)
const char* args = "[\"-la\", \"/tmp\"]";
int exit_code = boxlite_execute(box, "/bin/ls", args, callback, NULL, &error);

// Cleanup
boxlite_shutdown_box(box, &error);
boxlite_runtime_free(runtime);
```

## Troubleshooting

**Error: "BoxLite library not found"**
- Run `cargo build --release -p boxlite-c` from the repository root

**Error: "BoxLite header not found"**
- The header is auto-generated by cbindgen during build
- Ensure the C SDK build completed successfully

**Runtime error: "dylib not found"**
- CMake sets RPATH automatically, but you can also set:
  ```bash
  export DYLD_LIBRARY_PATH=../../target/release  # macOS
  export LD_LIBRARY_PATH=../../target/release    # Linux
  ```
